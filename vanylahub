local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

local function ultraOptimize()
    Workspace.StreamingEnabled = true
    Lighting.GlobalShadows = false
    Lighting.Technology = Enum.Technology.Legacy
    Lighting.FogEnd = 1000000
    Lighting.FogStart = 1000000
    Lighting.Brightness = 5
    Lighting.Ambient = Color3.fromRGB(178, 178, 178)
    Lighting.OutdoorAmbient = Color3.fromRGB(178, 178, 178)
    Lighting.ColorShift_Bottom = Color3.fromRGB(255, 255, 255)
    Lighting.ColorShift_Top = Color3.fromRGB(255, 255, 255)
    pcall(function()
        settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
        settings().Rendering.MeshPartDetailLevel = Enum.MeshPartDetailLevel.Level01
        settings().Rendering.GraphicsMode = Enum.GraphicsMode.Direct3D9
        settings().Physics.AllowSleep = true
        settings().Physics.ThrottleAdjustTime = 0
    end)
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("BasePart") then
            obj.Material = Enum.Material.Plastic
            obj.Reflectance = 0
            obj.CastShadow = false
        elseif obj:IsA("Decal") or obj:IsA("Texture") then
            obj.Transparency = 1
        elseif obj:IsA("ParticleEmitter") or obj:IsA("Fire") or obj:IsA("Smoke") or obj:IsA("Sparkles") then
            obj.Enabled = false
        elseif obj:IsA("PointLight") or obj:IsA("SpotLight") or obj:IsA("SurfaceLight") or obj:IsA("BloomEffect") or obj:IsA("BlurEffect") or obj:IsA("ColorCorrectionEffect") then
            obj.Enabled = false
        elseif obj:IsA("Atmosphere") then
            obj.Density = 0
            obj.Offset = 0
            obj.Glare = 0
            obj.Haze = 0
        elseif obj:IsA("Clouds") then
            obj.Enabled = false
            obj.Density = 0
        elseif obj:IsA("Wind") then
            obj.Enabled = false
        elseif obj:IsA("Sound") and obj.IsPlaying then
            obj.Volume = 0
        elseif obj:IsA("Terrain") then
            obj.WaterWaveSize = 0
            obj.WaterWaveSpeed = 0
            obj.WaterReflectance = 0
            obj.WaterTransparency = 0.5
            obj.WaterColor = Color3.fromRGB(0, 150, 255)
            obj:ReplaceMaterial(Enum.Material.Grass, Enum.Material.SmoothPlastic)
        end
    end
end

ultraOptimize()

local range = 20
local rays = 36

local function scanBarriers()
    for _, v in pairs(Workspace:GetChildren()) do
        if v.Name == "BarrierMarker" then
            v:Destroy()
        end
    end
    for i = 1, rays do
        local angle = math.rad((i / rays) * 360)
        local direction = Vector3.new(math.cos(angle), 0, math.sin(angle)) * range
        local ray = Ray.new(hrp.Position, direction)
        local part, pos = Workspace:FindPartOnRay(ray, character)
        if part and part.CanCollide then
            local marker = Instance.new("Part")
            marker.Name = "BarrierMarker"
            marker.Size = Vector3.new(1,1,1)
            marker.Anchored = true
            marker.CanCollide = false
            marker.Color = Color3.fromRGB(255,0,0)
            marker.Material = Enum.Material.Neon
            marker.Transparency = 0
            marker.CFrame = CFrame.new(pos)
            marker.Parent = Workspace
        end
    end
end

RunService.RenderStepped:Connect(scanBarriers)